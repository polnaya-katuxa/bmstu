
(defun add_monomial (m p)
   (cond 
      ((zerop (car m)) p)
      (t (cons m p))
   )
)

; По возрастанию степеней
(defun sum_pol1 (p1 p2 res)
   (cond
      ((and (null p1) (null p2)) res) ; Если оба пустые, возвращаем результат
      ((null p1) (sum_pol1 p1 (cdr p2) (cons (car p2) res))) ; Если первый пустой, добавляем элемент второго
      ((null p2) (sum_pol1 (cdr p1) p2 (cons (car p1) res))) ; Если второй пустой, добавляем элемент первого
      ((> (cdar p1) (cdar p2)) (sum_pol1 (cdr p1) p2 (cons (car p1) res)))
      ((< (cdar p1) (cdar p2)) (sum_pol1 p1 (cdr p2) (cons (car p2) res)))
      (t (sum_pol1 (cdr p1) (cdr p2) (add_monomial (cons (+ (caar p1) (caar p2)) (cdar p1)) res)))
   )
)

(defun sum_pol_bin (p1 p2)
   (reverse (sum_pol1 p1 p2 NIL))
)

(defun pol_neg (p)
   (mapcar
      #'(lambda (el) (cons (- (car el)) (cdr el)))
      p
   )
)

(defun sub_pol_bin (p1 p2)
   (sum_pol_bin p1 (pol_neg p2))
)

(defun sum_pol (p &rest prest)
   (reduce
      #'sum_pol_bin
      prest
      :initial-value p
   )
)

(defun sub_pol (p &rest prest)
   (reduce
      #'sub_pol_bin
      prest
      :initial-value p
   )
)

(defun mul_pol_by_mon (m p)
   (mapcar
      #'(lambda (el) (cons (* (car el) (car m)) (+ (cdr el) (cdr m))))
      p
   )
)

(defun mul_pol_bin (p1 p2)
   (reduce
      #'sum_pol_bin
      (mapcar
         #'(lambda (el) (mul_pol_by_mon el p2))
         p1
      )
      :initial-value ()
   )
)


(defun mul_pol (p &rest prest)
   (reduce
      #'mul_pol_bin
      prest
      :initial-value p
   )
)

; p1, p2 - reversed
(defun div_coef (p1 p2)
   (cons (/ (caar p1) (caar p2)) (- (cdar p1) (cdar p2)))
)

(defun div_pol_bin1 (p1 p2 res)
   (cond
      ((or (null p1) (null p2)) NIL)
      ((< (cdar p1) (cdar p2)) (list (reverse res) p1))
      (t (div_pol_bin1 (sub_pol_bin p1 (mul_pol_by_mon (div_coef p1 p2) p2)) p2 (cons (div_coef p1 p2) res)))
   )
)

(defun div_pol_bin (p1 p2)
   (div_pol_bin1 p1 p2 NIL)
)

(defun div_pol (p &rest prest)
   (reduce
      #'(lambda (res el) (car (div_pol_bin res el)))
      prest
      :initial-value p
   )
)

(print (div_pol '((81 . 500) (887 . 499)(847 . 498) (59 . 497) (81 . 496) (318 . 495) (425 . 494) (540 . 493) (456 . 492) (300 . 491) (694 . 490) (511 . 489) (162 . 488) (89 . 487) (728 . 486) (274 . 485) (211 . 484) (445 . 483) (237 . 482) (106 . 481) (495 . 480) (466 . 479) (528 . 478) (258 . 477) (47 . 476) (947 . 475) (287 . 474) (888 . 473) (790 . 472) (15 . 471) (541 . 470) (408 . 469) (387 . 468) (831 . 467) (429 . 466) (356 . 465) (737 . 464) (631 . 463) (485 . 462) (26 . 461) (413 . 460) (90 . 459) (194 . 458) (563 . 457) (433 . 456) (147 . 455) (78 . 454) (324 . 453) (159 . 452) (353 . 451) (957 . 450) (721 . 449) (189 . 448) (199 . 447) (0 . 446) (705 . 445) (888 . 444) (538 . 443) (703 . 442) (355 . 441) (451 . 440) (510 . 439) (605 . 438) (156 . 437) (266 . 436) (828 . 435) (561 . 434) (202 . 433) (783 . 432) (746 . 431) (563 . 430) (376 . 429) (2 . 428) (718 . 427) (447 . 426) (94 . 425) (577 . 424) (463 . 423) (996 . 422) (420 . 421) (623 . 420) (953 . 419) (137 . 418) (133 . 417) (241 . 416) (59 . 415) (33 . 414) (643 . 413) (891 . 412) (2 . 411) (878 . 410) (336 . 409) (546 . 408) (107 . 407) (940 . 406) (503 . 405) (552 . 404) (843 . 403) (205 . 402) (598 . 401) (425 . 400) (351 . 399) (515 . 398) (757 . 397) (687 . 396) (10 . 395) (410 . 394) (285 . 393) (590 . 392) (632 . 391) (98 . 390) (553 . 389) (591 . 388) (582 . 387) (384 . 386) (297 . 385) (267 . 384) (137 . 383) (271 . 382) (894 . 381) (726 . 380) (802 . 379) (981 . 378) (79 . 377) (66 . 376) (270 . 375) (493 . 374) (86 . 373) (819 . 372) (981 . 371) (52 . 370) (175 . 369) (885 . 368) (710 . 367) (387 . 366) (749 . 365) (528 . 364) (818 . 363) (384 . 362) (903 . 361) (224 . 360) (547 . 359) (612 . 358) (532 . 357) (616 . 356) (839 . 355) (540 . 354) (786 . 353) (51 . 352) (76 . 351) (640 . 350) (351 . 349) (844 . 348) (364 . 347) (305 . 346) (183 . 345) (801 . 344) (90 . 343) (602 . 342) (258 . 341) (767 . 340) (231 . 339) (578 . 338) (154 . 337) (822 . 336) (223 . 335) (342 . 334) (208 . 333) (743 . 332) (968 . 331) (166 . 330) (710 . 329) (535 . 328) (440 . 327) (904 . 326) (162 . 325) (657 . 324) (415 . 323) (371 . 322) (39 . 321) (430 . 320) (513 . 319) (700 . 318) (359 . 317) (720 . 316) (783 . 315) (870 . 314) (984 . 313) (247 . 312) (10 . 311) (565 . 310) (162 . 309) (829 . 308) (920 . 307) (48 . 306) (756 . 305) (695 . 304) (666 . 303) (200 . 302) (456 . 301) (629 . 300) (92 . 299) (831 . 298) (577 . 297) (886 . 296) (320 . 295) (399 . 294) (162 . 293) (447 . 292) (292 . 291) (888 . 290) (611 . 289) (103 . 288) (888 . 287) (318 . 286) (756 . 285) (19 . 284) (807 . 283) (157 . 282) (652 . 281) (675 . 280) (181 . 279) (853 . 278) (795 . 277) (417 . 276) (393 . 275) (470 . 274) (996 . 273) (386 . 272) (632 . 271) (520 . 270) (260 . 269) (922 . 268) (29 . 267) (661 . 266) (60 . 265) (420 . 264) (79 . 263) (954 . 262) (464 . 261) (60 . 260) (551 . 259) (181 . 258) (757 . 257) (516 . 256) (600 . 255) (39 . 254) (637 . 253) (533 . 252) (561 . 251) (804 . 250) (685 . 249) (509 . 248) (215 . 247) (719 . 246) (14 . 245) (40 . 244) (662 . 243) (740 . 242) (0 . 241) (284 . 240) (173 . 239) (235 . 238) (443 . 237) (421 . 236) (390 . 235) (574 . 234) (869 . 233) (70 . 232) (336 . 231) (338 . 230) (472 . 229) (544 . 228) (395 . 227) (174 . 226) (237 . 225) (524 . 224) (293 . 223) (606 . 222) (648 . 221) (352 . 220) (420 . 219) (622 . 218) (371 . 217) (117 . 216) (151 . 215) (265 . 214) (682 . 213) (479 . 212) (592 . 211) (129 . 210) (231 . 209) (721 . 208) (855 . 207) (511 . 206) (343 . 205) (53 . 204) (166 . 203) (859 . 202) (867 . 201) (408 . 200) (8 . 199) (528 . 198) (653 . 197) (774 . 196) (284 . 195) (375 . 194) (874 . 193) (106 . 192) (537 . 191) (286 . 190) (467 . 189) (114 . 188) (658 . 187) (259 . 186) (546 . 185) (723 . 184) (724 . 183) (587 . 182) (657 . 181) (374 . 180) (39 . 179) (531 . 178) (146 . 177) (983 . 176) (928 . 175) (516 . 174) (926 . 173) (477 . 172) (412 . 171) (36 . 170) (51 . 169) (105 . 168) (762 . 167) (789 . 166) (698 . 165) (887 . 164) (430 . 163) (409 . 162) (128 . 161) (159 . 160) (861 . 159) (602 . 158) (418 . 157) (345 . 156) (871 . 155) (653 . 154) (240 . 153) (120 . 152) (81 . 151) (405 . 150) (276 . 149) (509 . 148) (466 . 147) (556 . 146) (695 . 145) (580 . 144) (834 . 143) (477 . 142) (267 . 141) (478 . 140) (175 . 139) (993 . 138) (380 . 137) (808 . 136) (631 . 135) (265 . 134) (558 . 133) (884 . 132) (442 . 131) (23 . 130) (162 . 129) (673 . 128) (972 . 127) (253 . 126) (158 . 125) (527 . 124) (496 . 123) (48 . 122) (513 . 121) (731 . 120) (574 . 119) (306 . 118) (740 . 117) (531 . 116) (332 . 115) (677 . 114) (402 . 113) (654 . 112) (483 . 111) (330 . 110) (686 . 109) (187 . 108) (462 . 107) (604 . 106) (421 . 105) (193 . 104) (398 . 103) (956 . 102) (765 . 101) (922 . 100) (45 . 99) (494 . 98) (806 . 97) (999 . 96) (24 . 95) (420 . 94) (44 . 93) (759 . 92) (7 . 91) (124 . 90) (357 . 89) (853 . 88) (774 . 87) (475 . 86) (740 . 85) (89 . 84) (814 . 83) (545 . 82) (339 . 81) (581 . 80) (131 . 79) (51 . 78) (985 . 77) (629 . 76) (203 . 75) (695 . 74) (92 . 73) (372 . 72) (275 . 71) (377 . 70) (262 . 69) (973 . 68) (17 . 67) (759 . 66) (807 . 65) (780 . 64) (205 . 63) (406 . 62) (474 . 61) (544 . 60) (723 . 59) (894 . 58) (922 . 57) (33 . 56) (574 . 55) (610 . 54) (30 . 53) (395 . 52) (914 . 51) (523 . 50) (650 . 49) (909 . 48) (277 . 47) (645 . 46) (671 . 45) (208 . 44) (198 . 43) (734 . 42) (879 . 41) (354 . 40) (721 . 39) (587 . 38) (326 . 37) (10 . 36) (921 . 35) (267 . 34) (301 . 33) (849 . 32) (488 . 31) (920 . 30) (374 . 29) (401 . 28) (140 . 27) (973 . 26) (596 . 25) (466 . 24) (75 . 23) (110 . 22) (872 . 21) (913 . 20) (214 . 19) (959 . 18) (325 . 17) (446 . 16) (921 . 15) (244 . 14) (63 . 13) (436 . 12) (487 . 11) (488 . 10) (223 . 9) (925 . 8) (26 . 7) (219 . 6) (200 . 5) (114 . 4) (730 . 3) (176 . 2) (300 . 1) ) '((51 . 500) (434 . 499)(619 . 498) (666 . 497) (913 . 496) (45 . 495) (541 . 494) (642 . 493) (239 . 492) (694 . 491) (221 . 490) (574 . 489) (701 . 488) (750 . 487) (485 . 486) (88 . 485) (864 . 484) (560 . 483) (216 . 482) (719 . 481) (582 . 480) (316 . 479) (813 . 478) (516 . 477) (322 . 476) (301 . 475) (555 . 474) (277 . 473) (963 . 472) (217 . 471) (758 . 470) (232 . 469) (179 . 468) (875 . 467) (333 . 466) (740 . 465) (627 . 464) (534 . 463) (552 . 462) (928 . 461) (37 . 460) (647 . 459) (969 . 458) (712 . 457) (346 . 456) (9 . 455) (104 . 454) (356 . 453) (314 . 452) (589 . 451) (223 . 450) (442 . 449) (764 . 448) (339 . 447) (730 . 446) (619 . 445) (953 . 444) (360 . 443) (894 . 442) (985 . 441) (721 . 440) (213 . 439) (401 . 438) (328 . 437) (757 . 436) (184 . 435) (262 . 434) (283 . 433) (721 . 432) (350 . 431) (315 . 430) (540 . 429) (492 . 428) (342 . 427) (591 . 426) (898 . 425) (401 . 424) (707 . 423) (912 . 422) (695 . 421) (516 . 420) (452 . 419) (283 . 418) (755 . 417) (769 . 416) (740 . 415) (694 . 414) (98 . 413) (590 . 412) (417 . 411) (882 . 410) (414 . 409) (370 . 408) (182 . 407) (268 . 406) (476 . 405) (526 . 404) (196 . 403) (825 . 402) (768 . 401) (762 . 400) (243 . 399) (251 . 398) (121 . 397) (713 . 396) (709 . 395) (93 . 394) (870 . 393) (937 . 392) (86 . 391) (841 . 390) (490 . 389) (798 . 388) (585 . 387) (401 . 386) (58 . 385) (718 . 384) (392 . 383) (735 . 382) (815 . 381) (681 . 380) (848 . 379) (356 . 378) (617 . 377) (74 . 376) (99 . 375) (573 . 374) (51 . 373) (161 . 372) (460 . 371) (92 . 370) (524 . 369) (214 . 368) (118 . 367) (63 . 366) (135 . 365) (748 . 364) (350 . 363) (40 . 362) (652 . 361) (390 . 360) (666 . 359) (799 . 358) (760 . 357) (794 . 356) (510 . 355) (351 . 354) (666 . 353) (601 . 352) (722 . 351) (60 . 350) (834 . 349) (13 . 348) (162 . 347) (898 . 346) (817 . 345) (93 . 344) (840 . 343) (53 . 342) (218 . 341) (601 . 340) (6 . 339) (188 . 338) (571 . 337) (577 . 336) (242 . 335) (817 . 334) (407 . 333) (284 . 332) (150 . 331) (907 . 330) (222 . 329) (945 . 328) (835 . 327) (248 . 326) (630 . 325) (904 . 324) (562 . 323) (752 . 322) (775 . 321) (114 . 320) (207 . 319) (453 . 318) (701 . 317) (173 . 316) (201 . 315) (195 . 314) (450 . 313) (45 . 312) (227 . 311) (299 . 310) (138 . 309) (399 . 308) (615 . 307) (775 . 306) (943 . 305) (340 . 304) (860 . 303) (539 . 302) (593 . 301) (551 . 300) (312 . 299) (778 . 298) (281 . 297) (106 . 296) (179 . 295) (615 . 294) (185 . 293) (511 . 292) (648 . 291) (314 . 290) (93 . 289) (836 . 288) (955 . 287) (360 . 286) (836 . 285) (906 . 284) (483 . 283) (128 . 282) (201 . 281) (612 . 280) (779 . 279) (563 . 278) (143 . 277) (787 . 276) (532 . 275) (523 . 274) (723 . 273) (825 . 272) (190 . 271) (277 . 270) (801 . 269) (501 . 268) (847 . 267) (808 . 266) (407 . 265) (659 . 264) (414 . 263) (96 . 262) (152 . 261) (364 . 260) (588 . 259) (237 . 258) (800 . 257) (192 . 256) (138 . 255) (395 . 254) (197 . 253) (144 . 252) (78 . 251) (608 . 250) (727 . 249) (63 . 248) (454 . 247) (352 . 246) (11 . 245) (401 . 244) (438 . 243) (272 . 242) (88 . 241) (780 . 240) (741 . 239) (671 . 238) (641 . 237) (314 . 236) (527 . 235) (636 . 234) (338 . 233) (784 . 232) (44 . 231) (237 . 230) (998 . 229) (523 . 228) (394 . 227) (995 . 226) (362 . 225) (635 . 224) (79 . 223) (107 . 222) (428 . 221) (82 . 220) (495 . 219) (856 . 218) (878 . 217) (989 . 216) (72 . 215) (141 . 214) (915 . 213) (602 . 212) (564 . 211) (920 . 210) (289 . 209) (503 . 208) (804 . 207) (300 . 206) (60 . 205) (879 . 204) (887 . 203) (815 . 202) (385 . 201) (198 . 200) (363 . 199) (325 . 198) (453 . 197) (251 . 196) (380 . 195) (332 . 194) (962 . 193) (832 . 192) (458 . 191) (464 . 190) (438 . 189) (249 . 188) (788 . 187) (809 . 186) (416 . 185) (356 . 184) (587 . 183) (972 . 182) (208 . 181) (244 . 180) (633 . 179) (346 . 178) (243 . 177) (601 . 176) (273 . 175) (344 . 174) (405 . 173) (800 . 172) (806 . 171) (155 . 170) (663 . 169) (378 . 168) (191 . 167) (561 . 166) (140 . 165) (312 . 164) (278 . 163) (444 . 162) (536 . 161) (312 . 160) (383 . 159) (411 . 158) (735 . 157) (971 . 156) (799 . 155) (158 . 154) (4 . 153) (801 . 152) (583 . 151) (816 . 150) (781 . 149) (296 . 148) (556 . 147) (89 . 146) (816 . 145) (317 . 144) (574 . 143) (777 . 142) (203 . 141) (666 . 140) (661 . 139) (784 . 138) (923 . 137) (429 . 136) (111 . 135) (183 . 134) (904 . 133) (650 . 132) (762 . 131) (991 . 130) (247 . 129) (510 . 128) (337 . 127) (464 . 126) (673 . 125) (457 . 124) (403 . 123) (181 . 122) (638 . 121) (617 . 120) (464 . 119) (676 . 118) (366 . 117) (135 . 116) (405 . 115) (585 . 114) (105 . 113) (479 . 112) (341 . 111) (763 . 110) (204 . 109) (319 . 108) (947 . 107) (883 . 106) (836 . 105) (210 . 104) (203 . 103) (330 . 102) (647 . 101) (907 . 100) (672 . 99) (804 . 98) (498 . 97) (691 . 96) (425 . 95) (337 . 94) (472 . 93) (143 . 92) (629 . 91) (4 . 90) (814 . 89) (289 . 88) (118 . 87) (892 . 86) (258 . 85) (650 . 84) (80 . 83) (978 . 82) (817 . 81) (325 . 80) (213 . 79) (269 . 78) (135 . 77) (910 . 76) (952 . 75) (171 . 74) (272 . 73) (209 . 72) (976 . 71) (987 . 70) (388 . 69) (146 . 68) (118 . 67) (933 . 66) (18 . 65) (983 . 64) (966 . 63) (293 . 62) (274 . 61) (521 . 60) (73 . 59) (848 . 58) (146 . 57) (4 . 56) (354 . 55) (963 . 54) (760 . 53) (491 . 52) (859 . 51) (332 . 50) (97 . 49) (999 . 48) (119 . 47) (799 . 46) (925 . 45) (783 . 44) (578 . 43) (830 . 42) (57 . 41) (917 . 40) (602 . 39) (922 . 38) (231 . 37) (972 . 36) (228 . 35) (882 . 34) (605 . 33) (118 . 32) (685 . 31) (593 . 30) (348 . 29) (225 . 28) (816 . 27) (871 . 26) (15 . 25) (76 . 24) (481 . 23) (694 . 22) (641 . 21) (509 . 20) (764 . 19) (158 . 18) (842 . 17) (590 . 16) (237 . 15) (821 . 14) (444 . 13) (411 . 12) (213 . 11) (224 . 10) (11 . 9) (533 . 8) (642 . 7) (182 . 6) (218 . 5) (626 . 4) (470 . 3) (570 . 2) (62 . 1) )))
