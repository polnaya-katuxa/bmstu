\usepackage{geometry} % Меняем поля страницы
\geometry{left=3cm} % Левое поле
\geometry{right=1.5cm} % Правое поле
\geometry{top=2cm} % Верхнее поле
\geometry{bottom=2cm} % Нижнее поле

\usepackage[T1]{fontenc}

% Использовать кодировку UTF-8
\usepackage[utf8]{inputenc}

% Русский язык с переносами
\usepackage[russian]{babel}

% Пакеты расширений
\usepackage{amsmath} 
\usepackage{amssymb}
\usepackage{caption}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{verbatimbox}
\usepackage{verbatim}
\usepackage{xcolor}
\usepackage{fancyvrb}
\usepackage{alltt}
\usepackage{tcolorbox}
\usepackage{etoolbox}
\usepackage{empheq}

\usepackage{tabularray}

\usepackage{booktabs}
\usepackage{siunitx}

\newcommand{\specialcell}[2][c]{%
	\begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}

%\makeatletter
%\def\env@cases{%
%  \let\@ifnextchar\new@ifnextchar
%  \left\lbrack
%  \def\arraystretch{1.2}%
%  \array{@{}l@{\quad}l@{}}%
%}
%\makeatother

% Начало абзаца с красной строки
\usepackage{indentfirst}

% minted - красивые листинги кода
\usepackage[cache=false]{minted}

% Оборачивать minted в красивый блок
\BeforeBeginEnvironment{minted}{\begin{tcolorbox}}
\AfterEndEnvironment{minted}{\end{tcolorbox}} 

% Переопределение пути к Pygmentize. Нужно далеко не всегда
\renewcommand{\MintedPygmentize}{/opt/homebrew/bin/pygmentize} 

% Путь к изображениям
\graphicspath{{images/}}

% Настройка расположения подписей 
\usepackage{caption}

% Объявление нового вида блоков кода
\newenvironment{code}{\captionsetup{type=listing}}{}
%\SetupFloatingEnvironment{listing}{name=Source Code}

% Разделитель номера и описания
\DeclareCaptionLabelSeparator{deffis}{ ~---~ }

% Расположение описания фигуры (рисунка)
\captionsetup[figure]{justification=centering,labelsep=deffis, format=plain}

% Расположение описания таблицы
\captionsetup[table]{justification=centering,labelsep=deffis, format=plain,singlelinecheck=false}

% Расположение описания листинга
\captionsetup[listing]{justification=centering,labelsep=deffis, format=plain,singlelinecheck=false}

% Настройка формата подписей
% Рисунок
\DeclareCaptionLabelFormat{gostfigure}{Рисунок #2}
\captionsetup[figure]{labelformat=gostfigure}

% Таблица
\DeclareCaptionLabelFormat{gosttable}{Таблица #2}
\captionsetup[table]{labelformat=gosttable}

% Листинг
%\DeclareCaptionLabelFormat{gostlisting}{Листинг #2}
%\captionsetup[listing]{labelformat=gostlisting}
\usepackage{listingsutf8}
\lstset{columns=fixed,basicstyle=\small,breaklines=true,inputencoding=utf8,keywordstyle=\bfseries\underbar,frame=single,tabsize=2,}
\lstset{extendedchars=\true}
\lstset{language=c}
\lstset{numbers=left,numberstyle=\small}

% Настройка нумерации глав - по ГОСТу, на конце точка
\renewcommand{\thechapter}{\arabic{chapter}.}

% Нумерация секции
% Между номером главы и номером секции никаких разделителей, потому что в результате предыдущей команды в конце номера главы и так стоит точка
\renewcommand{\thesection}{\thechapter\arabic{section}.}

% Нумерация подсекции
\renewcommand{\thesubsection}{\thesection\arabic{subsection}.}

\renewcommand{\thesubsubsection}{\thesubsection\arabic{subsubsection}.}

% Нумерация фигуры (рисунка). Переопределяется без разделителя, так как точка уже есть в конце номера главы
\renewcommand{\thefigure}{\thechapter\arabic{figure}}

% Таблица
\renewcommand{\thetable}{\thechapter\arabic{table}}

% Листинг
\renewcommand{\thelisting}{\thechapter\arabic{listing}}

% Формула
\renewcommand{\theequation}{\thechapter\arabic{equation}}

\usepackage{titlesec}
%\titlelabel{\thetitle.\quad}
%
\titleformat{\chapter}[display]
    {\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter}{0pt}{0pt}{30pt}
%
%\renewcommand{\thechapter}{\arabic{chapter}.}

\titleformat{\chapter}[block]
  {\normalfont\huge\bfseries}{\thechapter}{1em}{\Huge}
\titlespacing*{\chapter}{0pt}{0pt}{14pt}